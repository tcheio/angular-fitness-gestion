<div class="planning-page">
  <h1>Planning & réservations</h1>
  <p class="subtitle">
    Réservez vos cours de Yoga, CrossFit, Cardio directement depuis le planning.
  </p>

  <table class="courses-table" *ngIf="(courses$ | async) as courses; else empty">
    <thead>
      <tr>
        <th>Cours</th>
        <th>Coach</th>
        <th>Date</th>
        <th>Salle</th>
        <th>Niveau</th>
        <th>Places</th>
        <th></th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let course of courses">
        <td>{{ course.title }}</td>
        <td>{{ course.coach }}</td>
        <td>
          {{ course.start | date: 'EEEE d MMM • HH:mm' }}
          –
          {{ course.end | date: 'HH:mm' }}
        </td>
        <td>{{ course.room }}</td>
        <td>
          <span
            class="badge"
            [ngClass]="{
              beginner: course.level === 'beginner',
              intermediate: course.level === 'intermediate',
              advanced: course.level === 'advanced'
            }"
          >
            {{ course.level }}
          </span>
        </td>
        <td>
          {{ course.participantsCount }}/{{ course.capacity }}
          <span class="remaining" *ngIf="getRemainingPlaces(course) > 0">
            ({{ getRemainingPlaces(course) }} restantes)
          </span>
          <span class="full" *ngIf="getRemainingPlaces(course) <= 0">
            Complet
          </span>
        </td>
        <td>
          <button
            class="btn primary"
            [disabled]="!canReserve(course)"
            (click)="reserve(course)"
          >
            Réserver
          </button>
        </td>
      </tr>
    </tbody>
  </table>

  <ng-template #empty>
    <p>Aucun cours pour le moment.</p>
  </ng-template>
</div>
